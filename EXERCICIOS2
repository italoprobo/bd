--1
SELECT NOME, DT_NASC FROM HOSPEDE ORDER BY NOME ASC, DT_NASC DESC;


--2
SELECT NOME AS CATEGORIA FROM CATEGORIA ORDER BY NOME ASC;


--3
SELECT VALOR_DIA, NUM FROM APTO AS AP JOIN
CATEGORIA AS CAT ON CAT.COD_CAT = AP.COD_CAT
ORDER BY VALOR_DIA ASC


--4
SELECT NOME, COUNT(CAT.COD_CAT) FROM CATEGORIA AS CAT JOIN 
APTO AS AP ON CAT.COD_CAT = AP.COD_CAT
GROUP BY CAT.COD_CAT HAVING COUNT(CAT.COD_CAT)=1;


--5
ALTER TABLE HOSPEDE add NACIONALIDADE VARCHAR(60);

SELECT NOME, EXTRACT(year from dt_nasc) as ano, 
EXTRACT(month from dt_nasc) as mes FROM HOSPEDE Where nacionalidade ILIKE 'BRASILEIRO' 


--6
SELECT H.NOME, AP.NUM, COUNT(HOS.COD_HOSPEDA) FROM HOSPEDE AS H 
JOIN HOSPEDAGEM AS HOS ON H.COD_HOSP = HOS.COD_HOSP 
JOIN APTO AS AP ON HOS.NUM = AP.NUM 
GROUP BY H.NOME, AP.NUM
ORDER BY COUNT(HOS.COD_HOSPEDA);


--7
SELECT NOME FROM CATEGORIA WHERE LENGTH() > 15
