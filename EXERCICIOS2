--1
SELECT NOME, DT_NASC FROM HOSPEDE ORDER BY NOME ASC, DT_NASC DESC;


--2
SELECT NOME AS CATEGORIA FROM CATEGORIA ORDER BY NOME ASC;


--3
SELECT VALOR_DIA, NUM FROM APTO AS AP JOIN
CATEGORIA AS CAT ON CAT.COD_CAT = AP.COD_CAT
ORDER BY VALOR_DIA ASC


--4
SELECT NOME, COUNT(CAT.COD_CAT) FROM CATEGORIA AS CAT JOIN 
APTO AS AP ON CAT.COD_CAT = AP.COD_CAT
GROUP BY CAT.COD_CAT HAVING COUNT(CAT.COD_CAT)=1;


--5
ALTER TABLE HOSPEDE add NACIONALIDADE VARCHAR(60);

SELECT NOME, EXTRACT(year from dt_nasc) as ano, 
EXTRACT(month from dt_nasc) as mes FROM HOSPEDE Where nacionalidade ILIKE 'BRASILEIRO' 


--6
SELECT H.NOME, AP.NUM, COUNT(HOS.COD_HOSPEDA) FROM HOSPEDE AS H 
JOIN HOSPEDAGEM AS HOS ON H.COD_HOSP = HOS.COD_HOSP 
JOIN APTO AS AP ON HOS.NUM = AP.NUM 
GROUP BY H.NOME, AP.NUM
ORDER BY COUNT(HOS.COD_HOSPEDA);


--7
SELECT NOME FROM CATEGORIA WHERE LENGTH(NOME) > 3


--8
SELECT AP.NUM, CAT.NOME FROM HOSPEDAGEM AS HOS 
JOIN APTO AS AP ON AP.NUM = HOS.NUM 
JOIN CATEGORIA AS CAT ON CAT.COD_CAT = AP.COD_CAT 
WHERE HOS.DT_ENTRADA > '2016-12-31' AND HOS.DT_SAIDA < '2018-01-01'


--9
CREATE TABLE FUNCIONARIO(
COD_FUNC INT NOT NULL PRIMARY KEY,
NOME CHAR(50) NOT NULL,
DT_NASC DATE NOT NULL,
SALARIO INT NOT NULL);
INSERT INTO FUNCIONARIO VALUES(1, 'ICARO', '2002-04-28', 4000),
(2, 'FELIPE', '2003-08-12', 1600);
ALTER TABLE HOSPEDAGEM ADD COD_FUNC INT 
ALTER TABLE HOSPEDAGEM ADD CONSTRAINT fk_cod_func
FOREIGN KEY (COD_FUNC) REFERENCES FUNCIONARIO (COD_FUNC)


--10
SELECT F.NOME, F.SALARIO + (COUNT(HOS.COD_HOSPEDA) * 10) FROM FUNCIONARIO AS F
JOIN HOSPEDAGEM AS HOS ON HOS.COD_FUNC = F.COD_FUNC GROUP BY F.COD_FUNC 


--11
SELECT CAT.NOME, AP.NUM FROM CATEGORIA AS CAT LEFT JOIN
APTO AS AP ON CAT.COD_CAT = AP.COD_CAT
ORDER BY CAT.NOME ASC, AP.NUM ASC


--12
SELECT CAT.NOME, COALESCE(CAST(AP.NUM AS VARCHAR), 'nÃ£o possui apartamento')
FROM CATEGORIA AS CAT
LEFT JOIN APTO AS AP ON CAT.COD_CAT = AP.COD_CAT
ORDER BY CAT.NOME ASC, AP.NUM ASC;


--13 
SELECT FUN.NOME FROM FUNCIONARIO AS FUN JOIN
HOSPEDAGEM AS HOS ON FUN.COD_FUNC = HOS.COD_FUNC JOIN
HOSPEDE AS H ON HOS.COD_HOSP = H.COD_HOSP JOIN 
APTO AS AP ON HOS.NUM = AP.NUM JOIN
CATEGORIA AS CAT ON AP.COD_CAT = CAT.COD_CAT 
WHERE H.NOME ILIKE 'ITALO' OR CAT.NOME ILIKE 'luxo';


--14
SELECT HOS.COD_HOSPEDA
FROM HOSPEDAGEM AS HOS
INNER JOIN APTO AS AP ON HOS.NUM = AP.NUM
INNER JOIN CATEGORIA AS CAT ON AP.COD_CAT = CAT.COD_CAT
INNER JOIN HOSPEDE AS H ON H.COD_HOSP = HOS.COD_HOSP
WHERE H.DT_NASC = (SELECT MIN(DT_NASC) FROM HOSPEDE) 
AND CAT.VALOR_DIA = (SELECT MAX(VALOR_DIA) FROM CATEGORIA)



--15
SELECT H_UM.NOME FROM HOSPEDE AS H_UM JOIN HOSPEDE AS H_DOIS ON
H_UM.DT_NASC = H_DOIS.DT_NASC WHERE H_DOIS.COD_HOSP = 2


--16 ta errada!!
SELECT H.NOME FROM HOSPEDE AS H JOIN 
HOSPEDAGEM AS HOS ON H.COD_HOSP = HOS.COD_HOSP JOIN
APTO AS AP ON AP.NUM = HOS.NUM JOIN
CATEGORIA AS CAT ON CAT.COD_CAT = AP.COD_CAT 
WHERE H.DT_NASC = (SELECT MIN(DT_NASC) FROM HOSPEDE)
AND CAT.VALOR_DIA = (SELECT MAX(VALOR_DIA) FROM CATEGORIA) AND
(DT_ENTRADA > '2016-12-31' AND DT_SAIDA < '2018-01-01') 
