CREATE TABLE CATEGORIA
(COD_CAT INT NOT NULL,
NOME VARCHAR(50) NOT NULL,
VALOR_DIA FLOAT NOT NULL,
CONSTRAINT PRI_CAT PRIMARY KEY(COD_CAT));

INSERT INTO CATEGORIA VALUES(1, 'LUXO', 700), (2, 'STANDART', 300), (3, 'PRESIDENCIAL', 2000);

CREATE TABLE APTO
(NUM INT NOT NULL PRIMARY KEY,
STATUS CHAR(1) NOT NULL,
COD_CAT INT NOT NULL REFERENCES CATEGORIA(COD_CAT));

INSERT INTO APTO VALUES (1, 'D', 2), (2, 'D', 1), (3, 'D', 3);

CREATE TABLE HOSPEDE
(COD_HOSP INT NOT NULL PRIMARY KEY,
NOME VARCHAR(50) NOT NULL, 
DT_NASC DATE);

INSERT INTO HOSPEDE VALUES (1, 'ITALO', '2003-07-12'), (2, 'NICOLAS', '2004-06-18'), (3, 'EMANUEL', '2004-04-10');

CREATE TABLE SERVICO
(COD_SERV INT NOT NULL PRIMARY KEY,
NOME VARCHAR(50) NOT NULL, 
VALOR FLOAT NOT NULL);

INSERT INTO SERVICO VALUES (1, 'ULTRA', 450), (2, 'HARDPLUS', 900), (3, 'OMEGA', 1200);

CREATE TABLE HOSPEDAGEM
(COD_HOSPEDA INT NOT NULL PRIMARY KEY,
COD_HOSP INT NOT NULL REFERENCES HOSPEDE(COD_HOSP),
NUM INT NOT NULL REFERENCES APTO(NUM),
DT_ENTRADA DATE NOT NULL,
DT_SAIDA DATE);

INSERT INTO HOSPEDAGEM VALUES (1, 1, 1, '2023-01-10', '2023-01-11'), (2, 2, 2, '2023-07-11', '2023-07-15'), (3, 3, 3, '2023-07-10', '2023-08-19');

CREATE TABLE SOLICITACAO
(COD_SOL INT NOT NULL PRIMARY KEY,
COD_HOSPEDA INT NOT NULL REFERENCES HOSPEDAGEM(COD_HOSPEDA),
COD_SERV INT NOT NULL REFERENCES SERVICO(COD_SERV),
QUANT INT NOT NULL,
DT_SOL DATE);

INSERT INTO SOLICITACAO VALUES (1, 1, 1, 2, '2023-01-10'), (2, 2, 2, 2, '2023-07-15'), (3, 3, 3, 5, '2023-08-19');






SELECT * FROM CATEGORIA C, APTO A WHERE C.COD_CAT = A.COD_CAT AND NOME = 'LUXO'


OBTER  NOME DOS HSPEDES QUE SE HOSPEDARAM EM APARTAENTOS DA CAEGORIA LUXO

SELECT H.NOME FROM HOSPEDE H, HOSPEDAGEM HO, APTO AP, CATEGORIA C WHERE H.COD_HOSP = HO.COD_HOSP AND HO.NUM = AP.NUM AND C.COD_CAT = AP.COD_CAT AND C.NOME ILIKE 'LUXO';



OBTER  NOME DOS HSPEDES QUE SE HOSPEDARAM EM APARTAENTOS DA CAEGORIA LUXO OU PRESIDENCIAL

SELECT H.NOME FROM HOSPEDE H, HOSPEDAGEM HO, APTO AP, CATEGORIA C WHERE H.COD_HOSP = HO.COD_HOSP AND HO.NUM = AP.NUM AND C.COD_CAT = AP.COD_CAT AND C.NOME IN ('LUXO', 'PRESIDENCIAL');

SELECT NUM FROM APTO AP INNER JOIN CATEGORIA C ON AP.COD_CAT=C.COD_CAT
WHERE NOME = 'LUXO';

SELECT NOME,NUM FROM APTO AP RIGHT JOIN CATEGORIA C ON AP.COD_CAT=C.COD_CAT


